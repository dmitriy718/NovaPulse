<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovaPulse - Command Center</title>
    <link rel="stylesheet" href="/static/css/dashboard.css?v=20260221a">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-grid"></div>
    <div class="scan-line"></div>

    <!-- Header HUD -->
    <header class="hud-header">
        <div class="hud-left">
            <div class="logo">
                <span class="logo-icon">‚óÜ</span>
                <span class="logo-text">NOVA|PULSE</span>
                <span class="logo-version">v3.5</span>
            </div>
            <div class="status-indicator" id="statusIndicator">
                <span class="pulse"></span>
                <span class="status-text" id="statusText">CONNECTING...</span>
            </div>
        </div>
        <div class="hud-center">
            <div class="hud-stat">
                <span class="hud-label">MODE</span>
                <span class="hud-value" id="tradingMode">--</span>
            </div>
            <div class="hud-stat">
                <span class="hud-label">UPTIME</span>
                <span class="hud-value" id="uptime">00:00:00</span>
            </div>
            <div class="hud-stat">
                <span class="hud-label">SCAN #</span>
                <span class="hud-value" id="scanCount">0</span>
            </div>
        </div>
        <div class="hud-right">
            <button class="control-btn" id="logoutBtn" onclick="logout()">‚éã LOGOUT</button>
            <button class="control-btn settings-header-btn" id="settingsHeaderBtn" onclick="openSettingsModal()">‚öô SETTINGS</button>
            <button class="control-btn pause-btn" id="pauseBtn" onclick="togglePause()">‚è∏ PAUSE</button>
            <button class="control-btn danger-btn" id="closeAllBtn" onclick="closeAll()">‚ö† CLOSE ALL</button>
        </div>
    </header>

    <!-- Main Grid -->
    <main class="dashboard-grid">

        <!-- PnL Card -->
        <section class="glass-card pnl-card">
            <div class="card-header">
                <h2>üí∞ PORTFOLIO</h2>
            </div>
            <div class="pnl-display">
                <div class="pnl-main">
                    <span class="pnl-label">Total P&L</span>
                    <span class="pnl-value" id="totalPnl">$0.00</span>
                </div>
                <div class="equity-line">
                    <span class="equity-label">Total Equity</span>
                    <span class="equity-value" id="totalEquity">$0.00</span>
                </div>
                <div class="pnl-grid">
                    <div class="pnl-item">
                        <span class="label">Unrealized</span>
                        <span class="value" id="unrealizedPnl">$0.00</span>
                    </div>
                    <div class="pnl-item">
                        <span class="label">Realized</span>
                        <span class="value" id="todayPnl">$0.00</span>
                    </div>
                    <div class="pnl-item">
                        <span class="label">Win Rate</span>
                        <span class="value" id="winRate">0%</span>
                    </div>
                    <div class="pnl-item">
                        <span class="label">Trades</span>
                        <span class="value" id="totalTrades">0</span>
                    </div>
                    <div class="pnl-item">
                        <span class="label">Open Pos</span>
                        <span class="value" id="openPositions">0</span>
                    </div>
                    <div class="pnl-item">
                        <span class="label">Drawdown</span>
                        <span class="value" id="drawdown">0%</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Favorites -->
        <section class="glass-card favorites-card">
            <div class="card-header">
                <h2>‚ù§Ô∏è FAVORITES</h2>
            </div>
            <div class="favorites-list" id="favoritesList">
                <div class="favorite-item empty">No favorites yet</div>
            </div>
        </section>

        <!-- AI Thought Feed -->
        <section class="glass-card thought-card">
            <div class="card-header">
                <h2>üß† AI THOUGHT LOG</h2>
                <div style="display:flex; gap:8px; align-items:center;">
                    <span class="live-dot" id="liveDot" title="Auto-scrolling to latest"></span>
                    <span class="badge" id="thoughtCount">0</span>
                </div>
            </div>
            <div class="thought-feed" id="thoughtFeed">
                <div class="thought-item loading">
                    <span class="thought-time">--:--:--</span>
                    <span class="thought-msg">Waiting for AI thoughts...</span>
                </div>
            </div>
        </section>

        <!-- Active Positions -->
        <section class="glass-card positions-card">
            <div class="card-header">
                <h2>üìä ACTIVE POSITIONS</h2>
                <button class="control-btn" type="button" onclick="downloadTradesCsv()">‚¨á TRADES CSV</button>
            </div>
            <div class="positions-table" id="positionsTable">
                <table>
                    <thead>
                        <tr>
                            <th>PAIR</th>
                            <th>SIDE</th>
                            <th>SIZE</th>
                            <th>ENTRY</th>
                            <th>CURRENT</th>
                            <th>P&L</th>
                            <th>CONF</th>
                            <th>STOP</th>
                        </tr>
                    </thead>
                    <tbody id="positionsBody">
                        <tr class="empty-row">
                            <td colspan="8">No open positions</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Algo Pulse (Strategy Monitor) -->
        <section class="glass-card strategy-card">
            <div class="card-header">
                <h2>‚ö° NOVA|PLAYBOOK</h2>
            </div>
            <div class="strategy-grid" id="strategyGrid">
                <div class="strategy-item">
                    <span class="strategy-name">LOADING</span>
                    <div class="strategy-bar"><div class="bar-fill" style="width:0%"></div></div>
                    <span class="strategy-stat">--</span>
                </div>
            </div>
        </section>

        <!-- Ticker Scanner -->
        <section class="glass-card scanner-card">
            <div class="card-header">
                <h2>üì° TICKER SCANNER</h2>
            </div>
            <div class="scanner-grid" id="scannerGrid">
                <!-- Populated dynamically -->
            </div>
        </section>

        <!-- Stock Scanner -->
        <section class="glass-card stock-scanner-card" id="stockScannerCard">
            <div class="card-header">
                <h2 id="stockScannerTitle">STOCK SCANNER | MARKET OPEN</h2>
            </div>
            <div class="stock-scanner-grid" id="stockScannerGrid">
                <div class="stock-item empty">No stock symbols tracked yet</div>
            </div>
            <div class="stock-scanner-overlay" id="stockScannerOverlay">MARKET CLOSED</div>
        </section>

        <!-- Risk Monitor -->
        <section class="glass-card risk-card">
            <div class="card-header">
                <h2>üõ°Ô∏è RISK SHIELD</h2>
            </div>
            <div class="risk-grid">
                <div class="risk-item">
                    <span class="label">Risk of Ruin</span>
                    <div class="risk-gauge">
                        <div class="gauge-fill" id="rorGauge" style="width:0%"></div>
                    </div>
                    <span class="risk-value" id="rorValue">0%</span>
                </div>
                <div class="risk-item">
                    <span class="label">Daily Loss</span>
                    <div class="risk-gauge">
                        <div class="gauge-fill" id="dailyLossGauge" style="width:0%"></div>
                    </div>
                    <span class="risk-value" id="dailyLossValue">$0.00</span>
                </div>
                <div class="risk-item">
                    <span class="label">Exposure</span>
                    <div class="risk-gauge">
                        <div class="gauge-fill" id="exposureGauge" style="width:0%"></div>
                    </div>
                    <span class="risk-value" id="exposureValue">$0.00</span>
                </div>
                <div class="risk-item">
                    <span class="label">DD Factor</span>
                    <span class="risk-value large" id="ddFactor">1.0x</span>
                </div>
            </div>
        </section>

    </main>

    <div id="algoTooltip" class="algo-tooltip hidden"></div>

    <!-- Scanner Chart Modal -->
    <div id="chartOverlay" class="chart-modal-overlay hidden" onclick="if(event.target===this)closeChartModal()">
        <div class="chart-modal">
            <div class="chart-modal-header">
                <div>
                    <h2 id="chartTitle">HEIKIN ASHI</h2>
                    <div class="chart-meta" id="chartMeta">Loading...</div>
                </div>
                <div class="chart-header-actions">
                    <button id="chartFavoriteBtn" class="chart-favorite-btn" type="button" title="Add to favorites">‚ô°</button>
                    <button class="chart-close-btn" type="button" onclick="closeChartModal()">&times;</button>
                </div>
            </div>
            <div class="chart-tf-row" id="chartTfRow">
                <button class="chart-tf-btn" type="button" data-tf="1m">1</button>
                <button class="chart-tf-btn active" type="button" data-tf="5m">5</button>
                <button class="chart-tf-btn" type="button" data-tf="15m">15</button>
                <button class="chart-tf-btn" type="button" data-tf="30m">30</button>
                <button class="chart-tf-btn" type="button" data-tf="1h">1H</button>
                <button class="chart-tf-btn" type="button" data-tf="1d">1D</button>
                <span class="chart-status" id="chartStatus"></span>
            </div>
            <div class="chart-share-row" id="chartShareRow">
                <button class="chart-share-btn share-facebook" type="button" data-share="facebook" aria-label="Share to Facebook" title="Share to Facebook"></button>
                <button class="chart-share-btn share-x" type="button" data-share="x" aria-label="Share to X" title="Share to X"></button>
                <button class="chart-share-btn share-instagram" type="button" data-share="instagram" aria-label="Share to Instagram" title="Share to Instagram"></button>
                <button class="chart-share-btn share-reddit" type="button" data-share="reddit" aria-label="Share to Reddit" title="Share to Reddit"></button>
                <button class="chart-share-btn share-discord" type="button" data-share="discord" aria-label="Share to Discord" title="Share to Discord"></button>
                <button class="chart-share-btn share-telegram" type="button" data-share="telegram" aria-label="Share to Telegram" title="Share to Telegram"></button>
                <button class="chart-share-btn share-stocktwits" type="button" data-share="stocktwits" aria-label="Share to Stocktwits" title="Share to Stocktwits"></button>
                <button class="chart-share-btn share-gmail" type="button" data-share="gmail" aria-label="Share to Gmail" title="Share to Gmail"></button>
            </div>
            <div class="chart-panels">
                <canvas id="priceChartCanvas" class="chart-canvas price"></canvas>
                <canvas id="rsiChartCanvas" class="chart-canvas rsi"></canvas>
                <canvas id="macdChartCanvas" class="chart-canvas macd"></canvas>
            </div>
            <div class="chart-watermark">
                <div>Nova by Horizon</div>
                <div id="chartWatermarkUrl">https://nova.horizonsvc.com</div>
            </div>
        </div>
    </div>

    <!-- Settings Modal Overlay -->
    <div id="settingsOverlay" class="settings-modal-overlay hidden" onclick="if(event.target===this)closeSettingsModal()">
        <div class="settings-modal">
            <div class="settings-modal-header">
                <h2>‚öôÔ∏è CONFIGURATION</h2>
                <button class="settings-close-btn" onclick="closeSettingsModal()">&times;</button>
            </div>
            <div class="settings-tabs">
                <button class="settings-tab active" data-tab="ai" onclick="switchSettingsTab('ai')">AI & CONFLUENCE</button>
                <button class="settings-tab" data-tab="risk" onclick="switchSettingsTab('risk')">RISK</button>
                <button class="settings-tab" data-tab="trading" onclick="switchSettingsTab('trading')">TRADING</button>
                <button class="settings-tab" data-tab="ml" onclick="switchSettingsTab('ml')">ML / LEARNING</button>
            </div>
            <div class="settings-modal-body" id="settingsModalBody">
                <!-- Rendered dynamically by JS -->
            </div>
            <div class="settings-modal-footer">
                <span class="settings-status" id="settingsStatus"></span>
                <div class="settings-footer-btns">
                    <button class="settings-btn cancel" onclick="closeSettingsModal()">CANCEL</button>
                    <button class="settings-btn save" id="settingsSaveBtn" onclick="saveSettings()">SAVE</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Toast -->
    <div id="settingsToast" class="settings-toast hidden"></div>

    <script src="/static/js/dashboard.js?v=20260221a"></script>
</body>
</html>
